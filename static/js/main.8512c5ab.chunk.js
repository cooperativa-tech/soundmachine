(this.webpackJsonp=this.webpackJsonp||[]).push([[0],[,function(e,n,t){"use strict";var r=new(window.AudioContext||window.webkitAudioContext),o=r.createScriptProcessor(4096,1,1);o.connect(r.destination);var a={audioContext:r,analyser:o,sourceNode:null,mediaRecorder:null,recording:null,chunks:[],pressedKeys:{},lastRecordingURL:null,lastRecordingBlob:null,sharingFocused:!1,mouthPosition:0};n.a=a},,,,,function(e,n,t){"use strict";t.d(n,"a",function(){return a}),t.d(n,"b",function(){return c});var r=t(31),o=t(0),a=(t(2),function(e){var n=e.leftMargin,t=e.selected,a=e.hasRecording,c=e.isRecording,i=Object(r.a)(e,["leftMargin","selected","hasRecording","isRecording"]);return Object(o.c)("div",Object.assign({css:{width:70,height:70,display:"flex",alignItems:"center",justifyContent:"center",background:t&&c?"#E24E4E":a?"#0078F0":"#2D2D2D",boxShadow:a?"0px 12px 20px rgba(0, 120, 240, 0.28)":"0px 8px 20px rgba(22, 22, 22, 0.28)",boxSizing:"border-box",borderRadius:8,color:"#FFF",marginLeft:n?10:0,position:"relative",textTransform:"uppercase"}},i),Object(o.c)("span",null,i.keycode))}),c=function(e){return Object(o.c)("div",Object.assign({css:{display:"flex"}},e),e.children)}},,function(e,n,t){"use strict";var r=new(t(27).a)("Button");r.version(1).stores({keys:"key"}),r.version(2).stores({keys:"key",keyboards:"hash"}),n.a=r},,,,,,,function(e,n,t){"use strict";t.d(n,"b",function(){return u}),t.d(n,"a",function(){return d});var r=t(3),o=t.n(r),a=t(4),c=t(28),i=!1,s=new(t.n(c).a);s.addEventListener("message",function(e){"ready"===e.data.message&&(i=!0)},{once:!0});var u=function(){var e=Object(a.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i){e.next=3;break}return e.next=3,new Promise(function(e){setTimeout(function n(){i?e():setTimeout(n,200)},200)});case 3:return console.log("starting share"),s.postMessage({message:"share"}),e.abrupt("return",new Promise(function(e,n){s.addEventListener("message",function(t){var r=t.data;"share"===r.message?e(r.hash):n("invalid message received")},{once:!0})}));case 6:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),d=function(){var e=Object(a.a)(o.a.mark(function e(n){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i){e.next=3;break}return e.next=3,new Promise(function(e){setTimeout(function n(){i?e():setTimeout(n,200)},200)});case 3:return console.log("starting download"),s.postMessage({message:"download",hash:n}),e.abrupt("return",new Promise(function(e,n){s.addEventListener("message",function(t){var r=t.data;console.log("cko asiasdfksadf"),"download"===r.message?e():n("invalid message received")},{once:!0})}));case 6:case"end":return e.stop()}},e)}));return function(n){return e.apply(this,arguments)}}()},,,,,,function(e,n,t){"use strict";(function(e){var r=t(22),o=t(7),a=t(12),c=t(13),i=t(16),s=t(14),u=t(17),d=t(3),l=t.n(d),f=t(4),p=t(5),b=t(10),h=t.n(b),g=t(2),O=t.n(g),y=t(0),m=t(9),v=t(6),j=t(24),w=t(30),k=t(29),x=t(1),R=t(8);function S(){var e=Object(r.a)(["\n              html,\n              body {\n                background-color: white;\n                color: #1b1b1b;\n                font-size: 18;\n                line-height: 1;\n                font-family: Arial;\n              }\n\n              body {\n                padding: 40px;\n              }\n            "]);return S=function(){return e},e}function D(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function C(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?D(t,!0).forEach(function(n){Object(o.a)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):D(t).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var P=["q","w","e","r","t","y","u","i","o","p"],L=["a","s","d","f","g","h","j","k","l"],E=["z","x","c","v","b","n","m"],F=[].concat(P,L,E);function B(){var e=Object(g.useState)([]),n=Object(p.a)(e,2),t=n[0],r=n[1],o=function(){var e=Object(f.a)(l.a.mark(function e(){var n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R.a.keyboards.toArray();case 2:n=e.sent,r(n);case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return Object(y.c)(m.a,{trigger:Object(y.c)("button",{css:{backgroundColor:"#2D2D2D",color:"white",fontSize:20,padding:"10px 20px",marginRight:40,borderRadius:4}},"Your keyboards"),onOpen:o,contentStyle:{padding:40},modal:!0},Object(y.c)("div",null,t.length>0?Object(y.c)(O.a.Fragment,null,Object(y.c)("h4",null,"Your keyboards:"),Object(y.c)("ul",null,t.map(function(e){var n=e.hash,t=e.name;return Object(y.c)("li",{key:n},Object(y.c)("a",{href:"".concat(window.location,"?hash=").concat(n)},t))}))):Object(y.c)("p",null,"You don't have any saved saved keyboards.")))}window.navigator.mediaDevices.getUserMedia({audio:!0}).then(function(e){try{x.a.mediaRecorder=new MediaRecorder(e),x.a.mediaRecorder.ondataavailable=function(e){x.a.recording&&x.a.chunks.push(e.data)},x.a.mediaRecorder.onstop=function(){var e=new Blob(x.a.chunks,{type:"audio/ogg; codecs=opus"});x.a.chunks=[],x.a.lastRecordingBlob=e,x.a.lastRecordingURL=window.URL.createObjectURL(e)}}catch(n){console.error(n)}}).catch(function(e){return console.error(e)});var K=function(n){function t(){var n;return Object(a.a)(this,t),(n=Object(i.a)(this,Object(s.a)(t).call(this))).downHandler=function(e){var t=e.key;if(!x.a.sharingFocused){var r=h.a.toLower(t);if(h.a.includes(F,r))if(!x.a.pressedKeys[r])if(!h.a.reduce(x.a.pressedKeys,function(e,n,t){return e||n&&r!==t},!1))if(x.a.pressedKeys[r]=!0,n.setState(C({},n.state,{recording:C({},n.state.recording),pressedKeys:C({},n.state.pressedKeys,Object(o.a)({},r,!0))})),r===t)n.playClip(t);else{if(x.a.recording)return;console.log("recording"),x.a.mediaRecorder.start(),x.a.recording=!0}}},n.upHandler=function(t){var r=t.key;if(!x.a.sharingFocused){var a=h.a.toLower(r);if(h.a.includes(F,a)&&x.a.pressedKeys[a]&&(x.a.pressedKeys[a]=!1,n.setState(C({},n.state,{recording:C({},n.state.recording),pressedKeys:C({},n.state.pressedKeys,Object(o.a)({},a,!1))})),x.a.recording)){console.log("saving recording");try{x.a.mediaRecorder.stop()}catch(c){console.warn(c)}e(function(){n.saveClip(a),x.a.recording=!1})}}},n.loadSound=function(e){return new Promise(function(n){var t=new XMLHttpRequest;t.open("GET",e,!0),t.responseType="arraybuffer",t.onload=function(){n(t.response)},t.onerror=function(){console.error(arguments)},t.send()})},n.saveClip=function(){var t=Object(f.a)(l.a.mark(function t(r){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(x.a.lastRecordingURL){t.next=2;break}return t.abrupt("return",e(function(){return n.saveClip(r)}));case 2:return n.setState({recordings:C({},n.state.recordings,Object(o.a)({},r,x.a.lastRecordingURL))}),x.a.lastRecordingURL=null,t.next=6,R.a.keys.put({key:r,blob:x.a.lastRecordingBlob});case 6:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),n.playClip=function(){var e=Object(f.a)(l.a.mark(function e(t){var r,o;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.state.recordings[t]){e.next=3;break}return e.abrupt("return");case 3:try{x.a.sourceNode&&(x.a.sourceNode.stop(),x.a.sourceNode.disconnect(x.a.analyser))}catch(a){console.warn(a)}return x.a.sourceNode=x.a.audioContext.createBufferSource(),x.a.sourceNode.connect(x.a.analyser),e.next=8,n.loadSound(r);case 8:o=e.sent,x.a.audioContext.decodeAudioData(o,function(e){console.log("buffer",e),x.a.sourceNode.buffer=e,x.a.sourceNode.loop=!1,x.a.sourceNode.start(0)},function(e){return console.error(e)});case 10:case"end":return e.stop()}},e)}));return function(n){return e.apply(this,arguments)}}(),n.state={pressedKeys:{},recording:!1,recordings:{},loading:!0},n}return Object(u.a)(t,n),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=Object(f.a)(l.a.mark(function e(){var n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.addEventListener("keydown",this.downHandler),window.addEventListener("keyup",this.upHandler),e.prev=2,e.next=5,R.a.keys.toArray();case 5:n=e.sent,this.setState({recordings:n.reduce(function(e,n){return e[n.key]=window.URL.createObjectURL(n.blob),e},{})}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.error(e.t0);case 12:this.setState({loading:!1});case 13:case"end":return e.stop()}},e,this,[[2,9]])}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){window.removeEventListener("keydown",this.downHandler),window.removeEventListener("keyup",this.upHandler)}},{key:"render",value:function(){return this.state.loading?null:this.props.children(this.state)}}]),t}(O.a.Component);n.a=function(){return Object(y.c)(K,null,function(e){var n=e.pressedKeys,t=e.recording,r=e.recordings;return Object(y.c)("div",null,Object(y.c)(y.a,{styles:Object(y.b)(S())}),Object(y.c)(k.a,null),Object(y.c)("h1",null,"Push to Talk"),Object(y.c)("div",{style:{display:"flex",justifyContent:"center"}},Object(y.c)("div",{css:{padding:40,display:"flex",justifyContent:"flex-start",alignItems:"flex-start",flexDirection:"column"}},Object(y.c)(v.b,null,P.map(function(e,o){return Object(y.c)(v.a,{selected:n[e],hasRecording:!!r[e],isRecording:t,key:e,leftMargin:0!==o,keycode:e})})),Object(y.c)(v.b,{css:{marginLeft:20,marginTop:10}},L.map(function(e,o){return Object(y.c)(v.a,{selected:n[e],hasRecording:!!r[e],isRecording:t,key:e,leftMargin:0!==o,keycode:e})})),Object(y.c)(v.b,{css:{marginLeft:50,marginTop:10,position:"relative"}},E.map(function(e,o){return Object(y.c)(v.a,{selected:n[e],key:e,hasRecording:!!r[e],isRecording:t,leftMargin:0!==o,keycode:e})}),Object(y.c)(v.a,{css:{width:100,position:"absolute",left:"0",transform:"translateX(calc(-100% - 10px))"},selected:!1,hasRecording:!1,isRecording:!1,keycode:"Shift"})))),Object(y.c)(j.a,null),Object(y.c)(w.a,null),Object(y.c)(B,null))})}}).call(this,t(19).setImmediate)},,,function(e,n,t){"use strict";t.d(n,"a",function(){return g});var r=t(12),o=t(13),a=t(16),c=t(14),i=t(17),s=t(2),u=t.n(s),d=t(0),l=t(1),f=t(25),p=t.n(f),b=t(26),h=t.n(b),g=function(e){function n(){var e;Object(r.a)(this,n),(e=Object(a.a)(this,Object(c.a)(n).call(this))).ref=u.a.createRef();var t=function(){e.ref.current&&(e.ref.current.style.transform="translate(-50%, calc(-50% + ".concat(l.a.mouthPosition,"px))"))};return l.a.analyser.onaudioprocess=function(e){for(var n=e.inputBuffer.getChannelData(0),r=e.outputBuffer.getChannelData(0),o=0;o<n.length;o++)r[o]=n[o],0!==n[o]&&(l.a.mouthPosition=100*Math.abs(n[o]),window.requestAnimationFrame(t))},e}return Object(i.a)(n,e),Object(o.a)(n,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){return Object(d.c)("div",{css:{position:"relative",width:300}},Object(d.c)("img",{css:{width:"100%"},src:p.a}),Object(d.c)("img",{ref:this.ref,css:{position:"absolute",width:"100%",top:"50%",left:"50%",transform:"translate(-50%, calc(-50% + ".concat(l.a.mouthPosition,"px))"),transition:"all linear 0.3s",zIndex:9},src:h.a}))}}]),n}(u.a.Component)},function(e,n,t){e.exports=t.p+"static/media/face.f302813b.png"},function(e,n,t){e.exports=t.p+"static/media/mouth.9227568e.png"},,function(e,n,t){e.exports=function(){return new Worker(t.p+"808c6dcf71f2b8cb3fce.worker.js")}},function(e,n,t){"use strict";t.d(n,"a",function(){return p});var r=t(3),o=t.n(r),a=t(4),c=t(5),i=t(2),s=t.n(i),u=t(9),d=t(0),l=t(15),f=function(e){var n,t=[],r=new RegExp("(?:\\?|&)"+e+"=(.*?)(?=&|$)","gi");for(;null!==(n=r.exec(document.location.search));)t.push(n[1]);return t}("hash")[0];function p(){var e=Object(i.useState)(!1),n=Object(c.a)(e,2),t=n[0],r=n[1],p=function(){var e=Object(a.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r(!0),e.next=3,Object(l.a)(f);case 3:window.location=window.location.href.split("?")[0];case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return f?Object(d.c)(u.a,{contentStyle:{padding:40},modal:!0,open:!0},t?Object(d.c)("div",null,"loading..."):Object(d.c)(s.a.Fragment,null,Object(d.c)("div",{css:{marginBottom:20}},"Do you want to replace your existing keyboard with the new one?"),Object(d.c)("button",{onClick:p,css:{marginRight:20}},"Yes!"),Object(d.c)("button",{onClick:function(){window.location=window.location.href.split("?")[0]}},"No"))):null}},function(e,n,t){"use strict";var r=t(3),o=t.n(r),a=t(7),c=t(4),i=t(5),s=t(2),u=t.n(s),d=t(0),l=t(9),f=t(1),p=t(8),b=t(15);function h(e){var n=Object(s.useState)(""),t=Object(i.a)(n,2),r=t[0],o=t[1];return Object(d.c)("div",{css:{display:"flex",alignItems:"center"}},Object(d.c)("input",{placeholder:"Your keyboard's name",value:r,onChange:function(e){return o(e.target.value)},css:{fontSize:"inherit",fontFamily:"inherit",height:40,paddingTop:0,paddingBottom:0,paddingLeft:10,borderColor:"#2D2D2D",borderRadius:4,borderWidth:2,paddingRight:10,marginRight:10}}),Object(d.c)("button",{disabled:!r,onClick:function(){return e.onComplete(r)},css:{backgroundColor:"#2D2D2D",color:"white",fontSize:20,padding:"10px 20px",borderRadius:4}},"Share keyboard"))}function g(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function O(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?g(t,!0).forEach(function(n){Object(a.a)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):g(t).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function y(){var e=Object(s.useState)({hash:null,name:null}),n=Object(i.a)(e,2),t=n[0],r=n[1];return Object(s.useEffect)(function(){t.name&&t.hash&&p.a.keyboards.put(t).then(console.log).catch(console.error)},[t]),Object(d.c)(l.a,{trigger:Object(d.c)("button",{css:{backgroundColor:"#2D2D2D",color:"white",fontSize:20,padding:"10px 20px",marginRight:40,borderRadius:4}},"Save and Share"),modal:!0,position:"right center",onOpen:function(){f.a.sharingFocused=!0,Object(b.b)().then(function(){var e=Object(c.a)(o.a.mark(function e(n){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.keyboards.put({hash:n,name:"my random name"});case 2:r(O({},t,{hash:n}));case 3:case"end":return e.stop()}},e)}));return function(n){return e.apply(this,arguments)}}())},onClose:function(){f.a.sharingFocused=!1,r({hash:null,name:null})},contentStyle:{padding:40,borderRadius:4}},Object(d.c)(u.a.Fragment,null,t.name?t.hash?Object(d.c)("div",null,Object(d.c)("p",null,"Share this link"),Object(d.c)("a",{href:"".concat(window.location,"?hash=").concat(t.hash)},"".concat(window.location,"?hash=").concat(t.hash))):Object(d.c)("div",null,"loading..."):Object(d.c)(h,{onComplete:function(e){return r(O({},t,{name:e}))}})))}t.d(n,"a",function(){return y})},,function(e,n,t){e.exports=t(41)},,,,,,,,,function(e,n,t){"use strict";t.r(n);var r=t(2),o=t.n(r),a=t(20),c=t.n(a),i=t(21);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(i.a,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}],[[32,1,2]]]);
//# sourceMappingURL=main.8512c5ab.chunk.js.map